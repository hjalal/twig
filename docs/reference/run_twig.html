<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function runs a twig model, which can be either a decision tree or a Markov model."><title>Run a twig model — run_twig • twig</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Run a twig model — run_twig"><meta property="og:description" content="This function runs a twig model, which can be either a decision tree or a Markov model."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">twig</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/decision_tree.html">Decision Tree Herpes Virus Encephalopathy</a>
    <a class="dropdown-item" href="../articles/markov_time_dep.html">A Tutorial for Time Dependent Markov Model</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.dashlab.ca/projects/decision_twig/">DecisionTwig</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/hjalal/twig">GitHub</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/hjalal/twig">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Run a twig model</h1>
      
      <div class="d-none name"><code>run_twig.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function runs a twig model, which can be either a decision tree or a Markov model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_twig</span><span class="op">(</span></span>
<span>  <span class="va">twig_obj</span>,</span>
<span>  <span class="va">params</span>,</span>
<span>  n_cycles <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  offset_trace_cycle <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ncore <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  progress_bar <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>twig_obj</dt>
<dd><p>A twig object created by the <code>twig</code> function.</p></dd>


<dt>params</dt>
<dd><p>A data frame or list of parameters to be used in the model.</p></dd>


<dt>n_cycles</dt>
<dd><p>An integer specifying the number of cycles for a Markov model. Default is NULL.</p></dd>


<dt>verbose</dt>
<dd><p>A logical value indicating whether to print detailed output. Default is FALSE.</p></dd>


<dt>parallel</dt>
<dd><p>A logical value indicating whether to run the model in parallel. Default is FALSE.</p></dd>


<dt>offset_trace_cycle</dt>
<dd><p>An integer specifying the offset trace cycle. Default is 1.
This is used to adjust the cycle number in the trace output. If set to 0, the initial state distribution will be used
as the first cycle. If set to 1, the initial state distribution will be ignored in the Markov trace.
In both situations, the total number of cycles will be the same as the input n_cycles.</p></dd>


<dt>ncore</dt>
<dd><p>An integer specifying the number of cores to use for parallel processing. Default is total number of cores - 1.</p></dd>


<dt>progress_bar</dt>
<dd><p>A logical value indicating whether to display a progress bar. Default is TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list containing the results of the model run. The list includes the following elements:</p><ul><li><p>mean_ev A matrix of size decision x reward containing the mean expected values (EV)s across simulations if params is a data.frame with more than 1 row.</p></li>
<li><p>sim_ev An array of size decision x reward x simulation containing the simulated expected values (EV) by simulation.</p></li>
</ul><p>The following will also be returned if verbose is TRUE for Markov models:</p><ul><li><p>sim: The simulation ID.  If params is a dataset, only the first simulation will be used (sim = 1).</p></li>
<li><p>evaluated_funs: A list of dataframes of evaluated functions. Each function returns a data frame enumerating the dependencies of the function along with the value returned by that function for each combination of values.</p></li>
<li><p>evaluated_prob_funs_combined: A data frame containing the evaluated probability function values for each state, cycle, decision, and event that are merged into a single dataframe.</p></li>
<li><p>path_event_options: A data frame of the event options along each path. Rows = paths, columns = event_options.</p></li>
<li><p>path_probs: A data frame containing the path probabilities for each state, cycle, and decision.</p></li>
<li><p>event_probs: A data frame containing the event options along each path and the destination.</p></li>
<li><p>markov_trans_probs: An array containing the transition probabilities for each origin state, destination state, cycle, and decision.</p></li>
<li><p>markov_trace: An array containing the Markov trace for each cycle, state, and decision.</p></li>
<li><p>cycle_rewards: An array containing the rewards for each cycle, state, decision, and reward.</p></li>
<li><p>cycle_ev: An array containing the Expected Value (EV) for each cycle, state, decision and reward. cycle_ev = markov_trace * cycle_rewards.</p></li>
<li><p>sim_ev: A matrix of total expected values (EV) of size decision x rewards.</p></li>
<li><p>mean_ev: A matrix of mean expected values (EV) across simulations. Since this is for a single simulation, mean_ev = sim_ev.</p></li>
</ul><p>The following will also be returned if verbose is TRUE for decision trees:</p><ul><li><p>sim: The simulation ID. If params is a dataset, only the first simulation will be used (sim = 1).</p></li>
<li><p>evaluated_funs: A list of dataframes of evaluated functions. Each function returns a data frame enumerating the dependencies of the function along with the value returned by that function for each combination of values.</p></li>
<li><p>evaluated_prob_funs_combined: A data frame of the probability function values evaluated by decision and events harmonized to the same combinations of decisions and events across all probability functions.</p></li>
<li><p>event_probs: A data frame containing the probability of event options by decision.</p></li>
<li><p>outcome_probs: A matrix of outcome probabilities. Outcomes are the terminal event transitions of size decision x outcomes.</p></li>
<li><p>path_event_options: A data frame of the event options along each path. Rows = paths, columns = events.</p></li>
<li><p>path_probs: A matrix containing the path probabilities of size decision x paths.</p></li>
<li><p>path_rewards: An array containing the path rewards of size decision x paths x rewards. Paths are indexed by their final outcomes in the twig and a key to event options is provided in path_event_options.</p></li>
<li><p>path_ev: An array containing the path expected values (EV) = path_probs x path_rewards. This is also of size decision x paths x rewards.</p></li>
<li><p>sim_ev: A matrix of total expected values (EV) of size decision x rewards.</p></li>
<li><p>mean_ev: A matrix of mean expected values (EV) across simulations. Since this is for a single simulation, mean_ev = sim_ev.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://hjalal.github.io/twig/articles/markov_time_dep.html" class="external-link">Markov model vignette</a>, and
<a href="https://hjalal.github.io/twig/articles/decision_tree.html" class="external-link">Decision tree vignette</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu">run_twig</span><span class="op">(</span><span class="va">mytwig</span>, <span class="va">params</span>, n_cycles <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># see the vignettes for more examples</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://www.dashlab.ca" class="external-link">Hawre Jalal</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

